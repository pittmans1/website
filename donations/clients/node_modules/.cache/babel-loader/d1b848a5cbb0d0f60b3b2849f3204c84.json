{"ast":null,"code":"import _regeneratorRuntime from\"/Users/scottpittman/Desktop/website/donations/clients/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/scottpittman/Desktop/website/donations/clients/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/scottpittman/Desktop/website/donations/clients/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{CardElement}from\"@stripe/react-stripe-js\";import{useStripe,useElements}from\"@stripe/react-stripe-js\";import'./CheckoutForm.css';import{stringify}from'uuid';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CheckoutForm(_ref){var totalCost=_ref.totalCost;var _useState=useState('default'),_useState2=_slicedToArray(_useState,2),status=_useState2[0],setStatus=_useState2[1];var stripe=useStripe();var elements=useElements();console.log(stripe);var submit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var token,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setStatus('submitting');_context.prev=2;_context.next=5;return stripe.createToken(\"pii\",{personal_id_number:\"123131185\"});case 5:token=_context.sent;_context.next=8;return fetch('/.netlify/functions/charge',{method:'POST',body:JSON.stringify({amount:totalCost*100,token:token})});case 8:response=_context.sent;if(!response.ok){_context.next=13;break;}setStatus('complete');_context.next=14;break;case 13:throw new Error('Network response was not ok.');case 14:_context.next=21;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](2);setStatus('error');console.log(_context.t0.message);console.log(stripe);case 21:case\"end\":return _context.stop();}}},_callee,null,[[2,16]]);}));return function submit(_x){return _ref2.apply(this,arguments);};}();if(status==='complete'){return/*#__PURE__*/_jsx(\"div\",{className:\"CheckoutForm-complete\",children:\"Payment successful!\"});}return/*#__PURE__*/_jsxs(\"form\",{className:\"CheckoutForm\",onSubmit:submit,children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Would you like to complete the purchase?\"}),/*#__PURE__*/_jsx(CardElement,{id:\"card-element\"}),/*#__PURE__*/_jsx(\"button\",{className:\"CheckoutForm-button\",type:\"submit\",disabled:status==='submitting',children:status==='submitting'?'Submitting':'Submit Order'}),status==='error'&&/*#__PURE__*/_jsx(\"div\",{className:\"CheckoutForm-error\",children:\"Something went wrong.\"})]});}export default CheckoutForm;","map":{"version":3,"sources":["/Users/scottpittman/Desktop/website/donations/clients/src/components/CheckoutForm/CheckoutForm.js"],"names":["React","useState","CardElement","useStripe","useElements","stringify","CheckoutForm","totalCost","status","setStatus","stripe","elements","console","log","submit","e","preventDefault","createToken","personal_id_number","token","fetch","method","body","JSON","amount","response","ok","Error","message"],"mappings":"qZAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,WAAT,KAA2B,yBAA3B,CACA,OACIC,SADJ,CAEIC,WAFJ,KAGS,yBAHT,CAIA,MAAO,oBAAP,CACA,OAASC,SAAT,KAA0B,MAA1B,C,wFAEA,QAASC,CAAAA,YAAT,MAAsC,IAAbC,CAAAA,SAAa,MAAbA,SAAa,eACRN,QAAQ,CAAC,SAAD,CADA,wCAC7BO,MAD6B,eACrBC,SADqB,eAEpC,GAAMC,CAAAA,MAAM,CAAGP,SAAS,EAAxB,CACA,GAAMQ,CAAAA,QAAQ,CAAGP,WAAW,EAA5B,CACDQ,OAAO,CAACC,GAAR,CAAYH,MAAZ,EACC,GAAMI,CAAAA,MAAM,2FAAG,iBAAMC,CAAN,qIACbA,CAAC,CAACC,cAAF,GAEAP,SAAS,CAAC,YAAD,CAAT,CAHa,sCAMSC,CAAAA,MAAM,CAACO,WAAP,CAAmB,KAAnB,CAAyB,CAC3CC,kBAAkB,CAAE,WADuB,CAAzB,CANT,QAMNC,KANM,qCAUUC,CAAAA,KAAK,CAAC,4BAAD,CAA+B,CACvDC,MAAM,CAAE,MAD+C,CAEvDC,IAAI,CAAEC,IAAI,CAAClB,SAAL,CAAe,CACnBmB,MAAM,CAAEjB,SAAS,CAAG,GADD,CAEnBY,KAAK,CAAEA,KAFY,CAAf,CAFiD,CAA/B,CAVf,QAUPM,QAVO,mBAkBPA,QAAQ,CAACC,EAlBF,0BAmBTjB,SAAS,CAAC,UAAD,CAAT,CAnBS,oCAqBH,IAAIkB,CAAAA,KAAJ,CAAU,8BAAV,CArBG,0FAwBXlB,SAAS,CAAC,OAAD,CAAT,CACAG,OAAO,CAACC,GAAR,CAAY,YAAIe,OAAhB,EACAhB,OAAO,CAACC,GAAR,CAAYH,MAAZ,EA1BW,qEAAH,kBAANI,CAAAA,MAAM,6CAAZ,CA+BA,GAAIN,MAAM,GAAK,UAAf,CAA2B,CACzB,mBAAO,YAAK,SAAS,CAAC,uBAAf,iCAAP,CACD,CAED,mBACE,cAAM,SAAS,CAAC,cAAhB,CAA+B,QAAQ,CAAEM,MAAzC,wBACE,gEADF,cAEE,KAAC,WAAD,EAAa,EAAE,CAAC,cAAhB,EAFF,cAGE,eACE,SAAS,CAAC,qBADZ,CAEE,IAAI,CAAC,QAFP,CAGE,QAAQ,CAAEN,MAAM,GAAK,YAHvB,UAKGA,MAAM,GAAK,YAAX,CAA0B,YAA1B,CAAyC,cAL5C,EAHF,CAUGA,MAAM,GAAK,OAAX,eACC,YAAK,SAAS,CAAC,oBAAf,mCAXJ,GADF,CAgBD,CAED,cAAeF,CAAAA,YAAf","sourcesContent":["import React, { useState } from 'react';\nimport { CardElement} from \"@stripe/react-stripe-js\";\nimport {\n    useStripe,\n    useElements\n  } from \"@stripe/react-stripe-js\"\nimport './CheckoutForm.css';\nimport { stringify } from 'uuid';\n\nfunction CheckoutForm({  totalCost }) {\n  const [status, setStatus] = useState('default');\n  const stripe = useStripe();\n  const elements = useElements();\n console.log(stripe)\n  const submit = async e => {\n    e.preventDefault();\n\n    setStatus('submitting');\n\n    try {\n      let  token  = await stripe.createToken(\"pii\",{\n        personal_id_number: \"123131185\"\n      })\n      \n      let response = await fetch('/.netlify/functions/charge', {\n        method: 'POST',\n        body: JSON.stringify({\n          amount: totalCost * 100,\n          token: token\n        }),\n      });\n\n      if (response.ok) {\n        setStatus('complete');\n      } else {\n        throw new Error('Network response was not ok.');\n      }\n    } catch (err) {\n      setStatus('error');\n      console.log(err.message)\n      console.log(stripe)\n      \n    }\n  };\n\n  if (status === 'complete') {\n    return <div className=\"CheckoutForm-complete\">Payment successful!</div>;\n  }\n\n  return (\n    <form className=\"CheckoutForm\" onSubmit={submit}>\n      <h4>Would you like to complete the purchase?</h4>\n      <CardElement id=\"card-element\"/>\n      <button\n        className=\"CheckoutForm-button\"\n        type=\"submit\"\n        disabled={status === 'submitting'}\n      >\n        {status === 'submitting' ? 'Submitting' : 'Submit Order'}\n      </button>\n      {status === 'error' && (\n        <div className=\"CheckoutForm-error\">Something went wrong.</div>\n      )}\n    </form>\n  );\n}\n\nexport default CheckoutForm;"]},"metadata":{},"sourceType":"module"}